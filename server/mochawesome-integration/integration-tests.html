<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:15,&quot;tests&quot;:83,&quot;passes&quot;:78,&quot;pending&quot;:0,&quot;failures&quot;:5,&quot;start&quot;:&quot;2025-07-04T01:09:50.781Z&quot;,&quot;end&quot;:&quot;2025-07-04T01:09:59.829Z&quot;,&quot;duration&quot;:9048,&quot;testsRegistered&quot;:83,&quot;passPercent&quot;:93.97590361445783,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;87c4d26c-6ef2-4eae-82e3-fa40b4fea529&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;329099f6-4a76-44a7-8535-e051bc58ace2&quot;,&quot;title&quot;:&quot;Auth API&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\auth.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\auth.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Auth API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Auth API \&quot;before all\&quot; hook in \&quot;Auth API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;app = (0, express_1.default)();\napp.use(express_1.default.json());\napp.use(&#x27;/api/auth&#x27;, auth_1.default);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f926e44f-5bf0-4263-aeff-fa6f3c8c12ca&quot;,&quot;parentUUID&quot;:&quot;329099f6-4a76-44a7-8535-e051bc58ace2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Auth API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Auth API \&quot;after each\&quot; hook in \&quot;Auth API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon_1.default.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d60b0954-d56f-471c-8647-559fedf883ec&quot;,&quot;parentUUID&quot;:&quot;329099f6-4a76-44a7-8535-e051bc58ace2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;title&quot;:&quot;/api/auth/register POST&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\auth.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\auth.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 for missing name&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for missing name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password are required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71b9c46b-0332-4ab9-9d72-f7bd6f9d4ebd&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for missing email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test name&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password are required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;efe2fe17-f1b0-429a-82f7-b28e36765913&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing password&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for missing password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password are required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f259957d-5110-4769-b44e-d57b37a05f74&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string name&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for non string name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: 123,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password need to be strings&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fb57793-3a73-4c25-b135-c8d726129ec5&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for non string email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test name&#x27;,\n                email: 123,\n                password: &#x27;password123&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password need to be strings&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc823069-18b7-4b6f-8b45-e21cf8228142&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string password&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for non string password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: 123\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;name, email and password need to be strings&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c956006-6d67-4933-8c34-c0104db7fb01&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failed email validation&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 500 for failed email validation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).throws(new Error(\&quot;Error related to searching user with email\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test user&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to determine validity of email&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a59d3dc-dc6f-417b-bc14-4533e77ce2b6&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for existing account&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 400 for existing account&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves({\n                _id: &#x27;existing_id&#x27;,\n                name: &#x27;Existing User&#x27;,\n                email: &#x27;existing@example.com&#x27;,\n                password: &#x27;hashed_password&#x27;,\n                isEmailVerified: true\n            });\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test user&#x27;,\n                email: &#x27;existing@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Email already exists. Pleast try logging in instead&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;979bda4e-12e7-47ce-9039-be3db2463ed6&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failed register&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 500 for failed register&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(null);\n            sinon_1.default.stub(authService_1.AuthService, &#x27;register&#x27;).throws(new Error(\&quot;Unknown error in register\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test user&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Registration failed. Please try again&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f667911-df06-4c83-adf2-3ee3a20a565d&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 201 on successful register&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/register POST should return 201 on successful register&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeUser = {\n                _id: &#x27;test user id&#x27;,\n                name: &#x27;test user&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test token&#x27;,\n                verificationTokenExpires: (new Date(Date.now() + 24 * 60 * 60 * 1000)).toISOString(),\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(null);\n            sinon_1.default.stub(authService_1.AuthService, &#x27;register&#x27;).resolves({\n                token: &#x27;123abc&#x27;,\n                user: fakeUser\n            });\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/register&#x27;)\n                .send({\n                name: &#x27;test user&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;password123&#x27;\n            })\n                .expect(201);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Registration successful! Your account has been created and verified&#x27;,\n                data: fakeUser,\n                token: &#x27;123abc&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c66b754f-3770-4f00-ab21-d203f2a6fc39&quot;,&quot;parentUUID&quot;:&quot;8a24b1f7-d7a9-4927-8f80-f8740e40457b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;71b9c46b-0332-4ab9-9d72-f7bd6f9d4ebd&quot;,&quot;efe2fe17-f1b0-429a-82f7-b28e36765913&quot;,&quot;f259957d-5110-4769-b44e-d57b37a05f74&quot;,&quot;9fb57793-3a73-4c25-b135-c8d726129ec5&quot;,&quot;dc823069-18b7-4b6f-8b45-e21cf8228142&quot;,&quot;2c956006-6d67-4933-8c34-c0104db7fb01&quot;,&quot;1a59d3dc-dc6f-417b-bc14-4533e77ce2b6&quot;,&quot;979bda4e-12e7-47ce-9039-be3db2463ed6&quot;,&quot;9f667911-df06-4c83-adf2-3ee3a20a565d&quot;,&quot;c66b754f-3770-4f00-ab21-d203f2a6fc39&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:101,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;title&quot;:&quot;/api/auth/login POST&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\auth.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\auth.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 for missing email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 400 for missing email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                password: &#x27;hashed-password&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Email and password are required\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f0f0848-7c95-4944-b4cb-0aa219254551&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing password&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 400 for missing password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: \&quot;test@example.com\&quot;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Email and password are required\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a72af59e-6fab-4a05-b26d-bc02d1a63200&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 400 for non string email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: 123,\n                password: &#x27;test-hash&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Email and password must be strings\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;609bbf3c-6913-4bea-8fb5-911c7c1ea90b&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string password&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 400 for non string password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: 123\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Email and password must be strings\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;093676ad-8dc8-4753-bc6a-a169fd193947&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for bad email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 401 for bad email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(null);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test-hash&#x27;\n            })\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Invalid email or password\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52c0275e-1032-46aa-a75a-db8669183bf2&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for unverified email&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 401 for unverified email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const unverifiedUser = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test-hash&#x27;,\n                isEmailVerified: false\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(unverifiedUser);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test-hash&#x27;\n            })\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Please verify your email before logging in\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47628235-5da0-4b73-9689-d87ee7500e74&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error during login&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 500 for unknown error during login&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const userWithPassword = {\n                _id: &#x27;test_id&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test-hash&#x27;,\n                isEmailVerified: true\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(userWithPassword);\n            sinon_1.default.stub(authService_1.AuthService, &#x27;login&#x27;).throws(new Error(\&quot;Some error during login\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test-hash&#x27;\n            })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: \&quot;Unknown authentication error\&quot;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ab5b731-6267-4152-ac29-545cbe74b642&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 with token and user for successful login&quot;,&quot;fullTitle&quot;:&quot;Auth API /api/auth/login POST should return 200 with token and user for successful login&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const userWithPassword = {\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;hashed-password&#x27;,\n                isEmailVerified: true,\n            };\n            const { password } = userWithPassword, userWithoutPassword = __rest(userWithPassword, [\&quot;password\&quot;]);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(userWithPassword);\n            sinon_1.default.stub(authService_1.AuthService, &#x27;login&#x27;).resolves({\n                token: &#x27;token123&#x27;,\n                user: userWithoutPassword\n            });\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/auth/login&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;hashed-password&#x27;\n            })\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Login successful&#x27;,\n                user: userWithoutPassword,\n                token: &#x27;token123&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94db23df-90ba-4046-95bf-dff26bfa6051&quot;,&quot;parentUUID&quot;:&quot;6a60811a-2a3f-4e7b-bdce-8dab1451cf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5f0f0848-7c95-4944-b4cb-0aa219254551&quot;,&quot;a72af59e-6fab-4a05-b26d-bc02d1a63200&quot;,&quot;609bbf3c-6913-4bea-8fb5-911c7c1ea90b&quot;,&quot;093676ad-8dc8-4753-bc6a-a169fd193947&quot;,&quot;52c0275e-1032-46aa-a75a-db8669183bf2&quot;,&quot;47628235-5da0-4b73-9689-d87ee7500e74&quot;,&quot;8ab5b731-6267-4152-ac29-545cbe74b642&quot;,&quot;94db23df-90ba-4046-95bf-dff26bfa6051&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;a4afc020-b481-4b8d-b224-2c28c80b53e4&quot;,&quot;title&quot;:&quot;Chat API&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chat.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\chat.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Chat API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Chat API \&quot;before all\&quot; hook in \&quot;Chat API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;app = (0, express_1.default)();\napp.use(express_1.default.json());\napp.use(&#x27;/api/chat&#x27;, chat_1.default);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44ff58ef-4699-4979-9897-6846dda06f09&quot;,&quot;parentUUID&quot;:&quot;a4afc020-b481-4b8d-b224-2c28c80b53e4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Chat API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Chat API \&quot;after each\&quot; hook in \&quot;Chat API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon_1.default.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b576b8a-d655-489d-b76f-810a7dd4f534&quot;,&quot;parentUUID&quot;:&quot;a4afc020-b481-4b8d-b224-2c28c80b53e4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;title&quot;:&quot;/api/chat POST&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chat.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\chat.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 for missing messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for missing messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;test@example.com&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;messages and email required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;982d45a1-6e77-475b-af39-31c70a743fe6&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing email&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for missing email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                messages: [\n                    {\n                        speaker: &#x27;user&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first reply&#x27;\n                    }\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;messages and email required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;256148af-b072-4d99-8958-d63c211ea1ac&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string email&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for non string email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: 123,\n                messages: [\n                    {\n                        speaker: &#x27;user&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first reply&#x27;\n                    }\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;email needs to be a string&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;343e9c7c-1ec5-4488-88a0-dab561f20f91&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non array messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for non array messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: &#x27;filler&#x27;\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;messages needs to be an array&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eadec754-15d9-496b-9bdc-1bdb1e0e0e06&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing text in messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for missing text in messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: [\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;user&#x27;,\n                    },\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid speaker or text found on message&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9b94c5f-bfde-4a26-831d-b4eeabb4bcd4&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing speaker in messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for missing speaker in messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: [\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        text: &#x27;first reply&#x27;\n                    },\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid speaker or text found on message&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd84bd99-38aa-458b-850b-30a0a49af4a7&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for invalid speaker in messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for invalid speaker in messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: [\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;NOT A BOT OR A USER&#x27;,\n                        text: &#x27;first reply&#x27;\n                    }\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid speaker or text found on message&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;97990065-2334-4a00-9c0d-8362d9835b30&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string text in messages&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 400 for non string text in messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: [\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;user&#x27;,\n                        text: 12345\n                    }\n                ]\n            })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid speaker or text found on message&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96c41db9-58af-4a17-ba14-b368b5142067&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failed save chat&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 500 for failed save chat&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(ChatService_1.ChatService, &#x27;saveChat&#x27;).throws(new Error(\&quot;Some error in save chat\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: [\n                    {\n                        speaker: &#x27;bot&#x27;,\n                        text: &#x27;first message&#x27;\n                    },\n                    {\n                        speaker: &#x27;user&#x27;,\n                        text: &#x27;first reply&#x27;\n                    }\n                ]\n            })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to save chat&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c979abf-f7e7-4bca-9b65-1091476a116d&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for working save chat&quot;,&quot;fullTitle&quot;:&quot;Chat API /api/chat POST should return 200 for working save chat&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const testDate = new Date(&#x27;2025-06-30T01:14:27.853Z&#x27;).toISOString();\n            const messagesData = [\n                {\n                    speaker: &#x27;bot&#x27;,\n                    text: &#x27;first message&#x27;,\n                    timestamp: testDate\n                },\n                {\n                    speaker: &#x27;user&#x27;,\n                    text: &#x27;first reply&#x27;,\n                    timestamp: testDate\n                }\n            ];\n            const mockChat = {\n                messages: messagesData,\n                email: &#x27;text@example.com&#x27;,\n                createdAt: testDate\n            };\n            sinon_1.default.stub(ChatService_1.ChatService, &#x27;saveChat&#x27;).resolves(mockChat);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chat&#x27;)\n                .send({\n                email: &#x27;text@example.com&#x27;,\n                messages: messagesData\n            })\n                .expect(201);\n            (0, chai_1.expect)(response.body).to.deep.equal(mockChat);\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a115fd0-62b8-41c2-b980-a026c92836b7&quot;,&quot;parentUUID&quot;:&quot;6f645428-8d95-411c-a9e9-704b52979562&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;982d45a1-6e77-475b-af39-31c70a743fe6&quot;,&quot;256148af-b072-4d99-8958-d63c211ea1ac&quot;,&quot;343e9c7c-1ec5-4488-88a0-dab561f20f91&quot;,&quot;eadec754-15d9-496b-9bdc-1bdb1e0e0e06&quot;,&quot;c9b94c5f-bfde-4a26-831d-b4eeabb4bcd4&quot;,&quot;dd84bd99-38aa-458b-850b-30a0a49af4a7&quot;,&quot;97990065-2334-4a00-9c0d-8362d9835b30&quot;,&quot;96c41db9-58af-4a17-ba14-b368b5142067&quot;,&quot;3c979abf-f7e7-4bca-9b65-1091476a116d&quot;,&quot;5a115fd0-62b8-41c2-b980-a026c92836b7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:51,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;db4640b9-0f40-451e-ada7-911d225b75ee&quot;,&quot;title&quot;:&quot;Chatbot API&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\chatbot.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Chatbot API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Chatbot API \&quot;before all\&quot; hook in \&quot;Chatbot API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;app = (0, express_1.default)();\napp.use(express_1.default.json());\napp.post(&#x27;/api/chatbot&#x27;, chatbot_1.postChat);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a318e8e2-8a6b-4455-a10b-d97862f94680&quot;,&quot;parentUUID&quot;:&quot;db4640b9-0f40-451e-ada7-911d225b75ee&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Chatbot API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Chatbot API \&quot;after each\&quot; hook in \&quot;Chatbot API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon_1.default.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de839f1d-96d6-4b4f-af6a-7b752793a9ae&quot;,&quot;parentUUID&quot;:&quot;db4640b9-0f40-451e-ada7-911d225b75ee&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;title&quot;:&quot;/api/chatbot POST&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\chatbot.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;returns 400 code for missing message&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 400 code for missing message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({})\n                .expect(400);\n            expect(response.body).to.deep.equal({ error: &#x27;Message is required&#x27; });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe2a7cc7-e1af-45e3-bd69-4b96b6dca9b8&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 400 code for wrong data type&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 400 code for wrong data type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: 0 })\n                .expect(400);\n            expect(response.body).to.deep.equal({ error: &#x27;Message is required&#x27; });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d066d27-8d80-4098-b9a5-8d88fc6f1f89&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 400 code for empty message&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 400 code for empty message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;\&quot; })\n                .expect(400);\n            expect(response.body).to.deep.equal({ error: &#x27;Message is required&#x27; });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e4449bc-8778-4a32-9b40-fd8dd0deaea1&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 500 code for failed chatbot API call&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 500 code for failed chatbot API call&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1332,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(AIService_1.AIService, &#x27;chatCompletionGithubModel&#x27;).throws(new Error(\&quot;some API error message\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;hi\&quot; })\n                .expect(500);\n            expect(response.body).to.deep.equal({ error: &#x27;Unable to call chatbot API&#x27; });\n        })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: expected 500 \&quot;Internal Server Error\&quot;, got 200 \&quot;OK\&quot;&quot;,&quot;estack&quot;:&quot;Error: expected 500 \&quot;Internal Server Error\&quot;, got 200 \&quot;OK\&quot;\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:68:10\n    at Generator.next (&lt;anonymous&gt;)\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:41:71\n    at new Promise (&lt;anonymous&gt;)\n    at __awaiter (src\\tests\\integration\\chatbot.test.ts:37:12)\n    at Context.&lt;anonymous&gt; (src\\tests\\integration\\chatbot.test.ts:63:67)\n    at processImmediate (node:internal/timers:485:21)\n----\n    at Test._assertStatus (node_modules\\supertest\\lib\\test.js:267:14)\n    at D:\\Uni\\C455\\Project\\team10\\server\\node_modules\\supertest\\lib\\test.js:323:13\n    at Test._assertFunction (node_modules\\supertest\\lib\\test.js:300:13)\n    at Test.assert (node_modules\\supertest\\lib\\test.js:179:23)\n    at Server.localAssert (node_modules\\supertest\\lib\\test.js:135:14)\n    at Object.onceWrapper (node:events:632:28)\n    at Server.emit (node:events:518:28)\n    at Server.emit (node:domain:489:12)\n    at emitCloseNT (node:net:2419:8)\n    at processTicksAndRejections (node:internal/process/task_queues:89:21)&quot;},&quot;uuid&quot;:&quot;fd45108f-b79c-49ed-b9e0-75c6fe8f5d51&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 500 code for incomplete chatbot response&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 500 code for incomplete chatbot response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1057,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(AIService_1.AIService, &#x27;chatCompletionGithubModel&#x27;).resolves({\n                chatbotMessage: \&quot;\&quot;,\n                productRequested: false,\n                productQuery: \&quot;\&quot;\n            });\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;give me an incomplete response\&quot; })\n                .expect(500);\n            expect(response.body).to.deep.equal({ error: &#x27;AI unable to respond&#x27; });\n        })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: expected 500 \&quot;Internal Server Error\&quot;, got 200 \&quot;OK\&quot;&quot;,&quot;estack&quot;:&quot;Error: expected 500 \&quot;Internal Server Error\&quot;, got 200 \&quot;OK\&quot;\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:83:10\n    at Generator.next (&lt;anonymous&gt;)\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:41:71\n    at new Promise (&lt;anonymous&gt;)\n    at __awaiter (src\\tests\\integration\\chatbot.test.ts:37:12)\n    at Context.&lt;anonymous&gt; (src\\tests\\integration\\chatbot.test.ts:73:71)\n    at processImmediate (node:internal/timers:485:21)\n----\n    at Test._assertStatus (node_modules\\supertest\\lib\\test.js:267:14)\n    at D:\\Uni\\C455\\Project\\team10\\server\\node_modules\\supertest\\lib\\test.js:323:13\n    at Test._assertFunction (node_modules\\supertest\\lib\\test.js:300:13)\n    at Test.assert (node_modules\\supertest\\lib\\test.js:179:23)\n    at Server.localAssert (node_modules\\supertest\\lib\\test.js:135:14)\n    at Object.onceWrapper (node:events:632:28)\n    at Server.emit (node:events:518:28)\n    at Server.emit (node:domain:489:12)\n    at emitCloseNT (node:net:2419:8)\n    at processTicksAndRejections (node:internal/process/task_queues:89:21)&quot;},&quot;uuid&quot;:&quot;ad5a1670-b4bd-4339-a35f-e3502720ca73&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 200 code for working chatbot API without products&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 200 code for working chatbot API without products&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1623,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(AIService_1.AIService, &#x27;chatCompletionGithubModel&#x27;).resolves({\n                chatbotMessage: \&quot;What would you like to search for?\&quot;,\n                productRequested: false,\n                productQuery: \&quot;\&quot;\n            });\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;test message\&quot; })\n                .expect(200);\n            expect(response.body).to.deep.equal({\n                chatbotMessage: \&quot;What would you like to search for?\&quot;,\n                productData: null\n            });\n        })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }&quot;,&quot;estack&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:99:37\n    at Generator.next (&lt;anonymous&gt;)\n    at fulfilled (src\\tests\\integration\\chatbot.test.ts:38:58)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot; {\n-   \&quot;chatbotMessage\&quot;: \&quot;I&#x27;m here to help you find the perfect laptops, phones, or computers. What device are you interested in today?\&quot;\n+   \&quot;chatbotMessage\&quot;: \&quot;What would you like to search for?\&quot;\n   \&quot;productData\&quot;: [null]\n }\n&quot;},&quot;uuid&quot;:&quot;df14afad-6981-4f04-99ef-6b2ed05c79fb&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 200 code for working chatbot API and failed product API&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 200 code for working chatbot API and failed product API&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1332,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(AIService_1.AIService, &#x27;chatCompletionGithubModel&#x27;).resolves({\n                chatbotMessage: \&quot;Here are some macbooks I found.\&quot;,\n                productRequested: true,\n                productQuery: \&quot;macbook\&quot;\n            });\n            sinon_1.default.stub(ProductService_1.ProductService, &#x27;searchProducts&#x27;).throws(new Error(\&quot;some API error message\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;I want some macbooks\&quot; })\n                .expect(200);\n            expect(response.body).to.deep.equal({\n                chatbotMessage: \&quot;Here are some macbooks I found.\&quot;,\n                productData: null\n            });\n        })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }&quot;,&quot;estack&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:118:37\n    at Generator.next (&lt;anonymous&gt;)\n    at fulfilled (src\\tests\\integration\\chatbot.test.ts:38:58)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot; {\n-   \&quot;chatbotMessage\&quot;: \&quot;I found some MacBook options for you! Would you like to see the latest models, or are you interested in specific features or price ranges?\&quot;\n+   \&quot;chatbotMessage\&quot;: \&quot;Here are some macbooks I found.\&quot;\n   \&quot;productData\&quot;: [null]\n }\n&quot;},&quot;uuid&quot;:&quot;dfd8c4df-9c49-419d-a969-22795f26793b&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;returns 200 code for working chatbot API and product API&quot;,&quot;fullTitle&quot;:&quot;Chatbot API /api/chatbot POST returns 200 code for working chatbot API and product API&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3094,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const mockProduct = {\n                product_id: \&quot;123\&quot;,\n                source: \&quot;Best Buy\&quot;,\n                title: \&quot;MacBook Pro\&quot;,\n                thumbnail: \&quot;image.jpg\&quot;,\n                extracted_price: 1299,\n                seller_details: { direct_link: \&quot;http://example.com\&quot; },\n                rating: 4.5,\n                reviews: 120\n            };\n            sinon_1.default.stub(AIService_1.AIService, &#x27;chatCompletionGithubModel&#x27;).resolves({\n                chatbotMessage: \&quot;Here are some macbooks I found.\&quot;,\n                productRequested: true,\n                productQuery: \&quot;macbook\&quot;\n            });\n            sinon_1.default.stub(ProductService_1.ProductService, &#x27;searchProducts&#x27;).resolves([mockProduct]);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/chatbot&#x27;)\n                .send({ message: \&quot;I want some macbooks\&quot; })\n                .expect(200);\n            expect(response.body).to.deep.equal({\n                chatbotMessage: \&quot;Here are some macbooks I found.\&quot;,\n                productData: [{\n                        id: mockProduct.product_id,\n                        source: mockProduct.source,\n                        title: mockProduct.title,\n                        image: mockProduct.thumbnail,\n                        price: mockProduct.extracted_price,\n                        url: mockProduct.seller_details.direct_link,\n                        rating: mockProduct.rating,\n                        reviews: mockProduct.reviews\n                    }]\n            });\n        })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }&quot;,&quot;estack&quot;:&quot;AssertionError: expected { …(2) } to deeply equal { …(2) }\n    at D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\chatbot.test.ts:147:37\n    at Generator.next (&lt;anonymous&gt;)\n    at fulfilled (src\\tests\\integration\\chatbot.test.ts:38:58)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot; {\n-   \&quot;chatbotMessage\&quot;: \&quot;I found a MacBook Pro available for $1299 with a 4.5-star rating and 120 reviews. You can view it [here](http://localhost:3000/api/buywise/redirect/1751591396873-ebl8es?data=eyJvcmlnaW5hbFVybCI6Imh0dHA6Ly9leGFtcGxlLmNvbSIsInBhcmFtcyI6eyJwcm9kdWN0X2lkIjoiMTIzIiwic291cmNlIjoiQmVzdCBCdXkiLCJ0aXRsZSI6Ik1hY0Jvb2sgUHJvIiwicHJpY2UiOjEyOTl9LCJyZWRpcmVjdFVybCI6Imh0dHA6Ly9leGFtcGxlLmNvbT9wcm9kdWN0X2lkPTEyMyZzb3VyY2U9QmVzdCtCdXkmdGl0bGU9TWFjQm9vaytQcm8mcHJpY2U9MTI5OSJ). Would you like to see more options or details?\&quot;\n+   \&quot;chatbotMessage\&quot;: \&quot;Here are some macbooks I found.\&quot;\n   \&quot;productData\&quot;: [\n     {\n       \&quot;id\&quot;: \&quot;123\&quot;\n       \&quot;image\&quot;: \&quot;image.jpg\&quot;\n       \&quot;rating\&quot;: 4.5\n       \&quot;reviews\&quot;: 120\n       \&quot;source\&quot;: \&quot;Best Buy\&quot;\n       \&quot;title\&quot;: \&quot;MacBook Pro\&quot;\n-       \&quot;url\&quot;: \&quot;http://localhost:3000/api/buywise/redirect/1751591396873-ebl8es?data=eyJvcmlnaW5hbFVybCI6Imh0dHA6Ly9leGFtcGxlLmNvbSIsInBhcmFtcyI6eyJwcm9kdWN0X2lkIjoiMTIzIiwic291cmNlIjoiQmVzdCBCdXkiLCJ0aXRsZSI6Ik1hY0Jvb2sgUHJvIiwicHJpY2UiOjEyOTl9LCJyZWRpcmVjdFVybCI6Imh0dHA6Ly9leGFtcGxlLmNvbT9wcm9kdWN0X2lkPTEyMyZzb3VyY2U9QmVzdCtCdXkmdGl0bGU9TWFjQm9vaytQcm8mcHJpY2U9MTI5OSJ9\&quot;\n+       \&quot;url\&quot;: \&quot;http://example.com\&quot;\n     }\n   ]\n }\n&quot;},&quot;uuid&quot;:&quot;4f30375e-53ea-4f3d-b471-973ae57fc8b6&quot;,&quot;parentUUID&quot;:&quot;055e0185-46ad-4f7e-9378-36857e1f5de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fe2a7cc7-e1af-45e3-bd69-4b96b6dca9b8&quot;,&quot;1d066d27-8d80-4098-b9a5-8d88fc6f1f89&quot;,&quot;7e4449bc-8778-4a32-9b40-fd8dd0deaea1&quot;],&quot;failures&quot;:[&quot;fd45108f-b79c-49ed-b9e0-75c6fe8f5d51&quot;,&quot;ad5a1670-b4bd-4339-a35f-e3502720ca73&quot;,&quot;df14afad-6981-4f04-99ef-6b2ed05c79fb&quot;,&quot;dfd8c4df-9c49-419d-a969-22795f26793b&quot;,&quot;4f30375e-53ea-4f3d-b471-973ae57fc8b6&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8453,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;c91a6168-f7ad-47a0-afb0-cb3c59785c21&quot;,&quot;title&quot;:&quot;Products API&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\products.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\products.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Products API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Products API \&quot;before all\&quot; hook in \&quot;Products API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;app = (0, express_1.default)();\napp.use(&#x27;/api/products&#x27;, products_1.default);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf3521f8-c4ee-45a6-bb00-50bbdd16c62c&quot;,&quot;parentUUID&quot;:&quot;c91a6168-f7ad-47a0-afb0-cb3c59785c21&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Products API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Products API \&quot;after each\&quot; hook in \&quot;Products API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon_1.default.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c86abca-4795-407a-bd57-355783284c93&quot;,&quot;parentUUID&quot;:&quot;c91a6168-f7ad-47a0-afb0-cb3c59785c21&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6b1c46c4-22cd-4bbe-8810-004f06e8bbcf&quot;,&quot;title&quot;:&quot;GET /api/products/search&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\products.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\products.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200 and products for a valid search query&quot;,&quot;fullTitle&quot;:&quot;Products API GET /api/products/search should return 200 and products for a valid search query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeProducts = [\n                {\n                    category: &#x27;Popular products&#x27;,\n                    thumbnail: &#x27;https://example.com/image.jpg&#x27;,\n                    source_logo: &#x27;https://example.com/logo.png&#x27;,\n                    source: &#x27;Best Buy&#x27;,\n                    title: &#x27;HP 14\&quot; Intel Celeron Laptop&#x27;,\n                    rating: 4.2,\n                    reviews: 148,\n                    price: &#x27;$199.99&#x27;,\n                    extracted_price: 199.99,\n                    location: &#x27;Nearby, 13 mi&#x27;,\n                    product_id: &#x27;2197135960910078338&#x27;,\n                    seller_details: [\n                        {\n                            position: 1,\n                            name: &#x27;Best Buy&#x27;,\n                            top_quality_store: true,\n                            payment_methods: &#x27;PayPal, Zip accepted&#x27;,\n                            rating: 4.6,\n                            reviews: 532,\n                            reviews_original: &#x27;(532)&#x27;,\n                            link: &#x27;https://google.com/redirect&#x27;,\n                            direct_link: &#x27;https://bestbuy.com/product&#x27;,\n                            details_and_offers: [{ text: &#x27;5.3 mi · In stock at GainesvilleToday: 10:00 AM - 8:00 PM&#x27; }],\n                            base_price: &#x27;$199.99&#x27;,\n                            additional_price: { shipping: &#x27;See website&#x27; },\n                            total_price: &#x27;$199.99&#x27;,\n                        }\n                    ],\n                },\n            ];\n            sinon_1.default.stub(ProductService_1.ProductService, &#x27;searchProducts&#x27;).resolves(fakeProducts);\n            const res = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/products/search&#x27;)\n                .query({ q: &#x27;Laptop under $400&#x27;, device: &#x27;desktop&#x27;, location: &#x27;Canada&#x27; });\n            (0, chai_1.expect)(res.status).to.equal(200);\n            (0, chai_1.expect)(res.body.success).to.be.true;\n            (0, chai_1.expect)(res.body.products).to.deep.equal(fakeProducts);\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c888fb6-09a6-4a21-9d09-8d33e53ad1ba&quot;,&quot;parentUUID&quot;:&quot;6b1c46c4-22cd-4bbe-8810-004f06e8bbcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if the search query is missing&quot;,&quot;fullTitle&quot;:&quot;Products API GET /api/products/search should return 400 if the search query is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const res = yield (0, supertest_1.default)(app).get(&#x27;/api/products/search&#x27;);\n            (0, chai_1.expect)(res.status).to.equal(400);\n            (0, chai_1.expect)(res.body.success).to.be.false;\n            (0, chai_1.expect)(res.body.error).to.equal(&#x27;Search query is required&#x27;);\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3372a122-fe45-4e67-a8dc-61ea40d1d9b1&quot;,&quot;parentUUID&quot;:&quot;6b1c46c4-22cd-4bbe-8810-004f06e8bbcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 if the ProductService throws an error&quot;,&quot;fullTitle&quot;:&quot;Products API GET /api/products/search should return 500 if the ProductService throws an error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(ProductService_1.ProductService, &#x27;searchProducts&#x27;).throws(new Error(&#x27;SerpAPI error&#x27;));\n            const res = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/products/search&#x27;)\n                .query({ q: &#x27;Laptop&#x27; });\n            (0, chai_1.expect)(res.status).to.equal(500);\n            (0, chai_1.expect)(res.body.success).to.be.false;\n            (0, chai_1.expect)(res.body.error).to.equal(&#x27;SerpAPI error&#x27;);\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae5e99f7-5145-4942-af87-6c927a3842e1&quot;,&quot;parentUUID&quot;:&quot;6b1c46c4-22cd-4bbe-8810-004f06e8bbcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4c888fb6-09a6-4a21-9d09-8d33e53ad1ba&quot;,&quot;3372a122-fe45-4e67-a8dc-61ea40d1d9b1&quot;,&quot;ae5e99f7-5145-4942-af87-6c927a3842e1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:19,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;e161f932-e353-4b9b-855f-01ce90d09415&quot;,&quot;title&quot;:&quot;Profile API&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Profile API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API \&quot;before all\&quot; hook in \&quot;Profile API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;app = (0, express_1.default)();\napp.use(express_1.default.json());\napp.use(&#x27;/api/profiles&#x27;, profile_1.default);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed5a7cb9-0498-4d37-9eaa-f484a0ef0c4a&quot;,&quot;parentUUID&quot;:&quot;e161f932-e353-4b9b-855f-01ce90d09415&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Profile API\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API \&quot;after each\&quot; hook in \&quot;Profile API\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon_1.default.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7fd729a-94bd-4c15-92b5-14bbc6a84e4b&quot;,&quot;parentUUID&quot;:&quot;e161f932-e353-4b9b-855f-01ce90d09415&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;title&quot;:&quot;/api/profiles/verify/:token GET&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 for missing token&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/verify/:token GET should return 400 for missing token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/verify&#x27;)\n                .query({})\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;token missing from params&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c30ca30b-918f-4ac3-83fd-3003625466a6&quot;,&quot;parentUUID&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failing to get user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/verify/:token GET should return 500 for failing to get user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByToken&#x27;).throws(new Error(\&quot;Some error related to getting user\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/verify/test123&#x27;)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to get user&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4bd8db36-c30c-4d9d-90ab-ce15d34fce0f&quot;,&quot;parentUUID&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for not finding valid user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/verify/:token GET should return 404 for not finding valid user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByToken&#x27;).resolves(null);\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/verify/test123&#x27;)\n                .expect(404);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid or expired verification token&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd61d39f-2459-42f8-a077-64a767e37a89&quot;,&quot;parentUUID&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failing to verify email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/verify/:token GET should return 500 for failing to verify email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeDate = (new Date()).toISOString();\n            const fakeUser = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test123&#x27;,\n                verificationTokenExpires: fakeDate,\n                createdAt: fakeDate,\n                updatedAt: fakeDate,\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByToken&#x27;).resolves(fakeUser);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;verifyEmail&#x27;).throws(new Error(\&quot;Some error related to verifying email\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/verify/test123&#x27;)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to verify email&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0eb2aa13-1be0-4fa1-87f8-e86faa677548&quot;,&quot;parentUUID&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for successfully verifying email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/verify/:token GET should return 200 for successfully verifying email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeDate = (new Date()).toISOString();\n            const fakeUser = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test123&#x27;,\n                verificationTokenExpires: fakeDate,\n                createdAt: fakeDate,\n                updatedAt: fakeDate,\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByToken&#x27;).resolves(fakeUser);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;verifyEmail&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/verify/test123&#x27;)\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Email verified successfully&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c6be15b-956d-474b-8185-6242073f964a&quot;,&quot;parentUUID&quot;:&quot;8003733a-2ca8-44fe-a475-12e7b0daafa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c30ca30b-918f-4ac3-83fd-3003625466a6&quot;,&quot;4bd8db36-c30c-4d9d-90ab-ce15d34fce0f&quot;,&quot;cd61d39f-2459-42f8-a077-64a767e37a89&quot;,&quot;0eb2aa13-1be0-4fa1-87f8-e86faa677548&quot;,&quot;7c6be15b-956d-474b-8185-6242073f964a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:29,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;title&quot;:&quot;/api/profiles/resend-verification POST&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 for missing email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 400 for missing email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({})\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;email is required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d25c1cf3-6f15-4d81-aeb3-65b59c7c4d0f&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 400 for non string email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: 123 })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;email must be a string&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;274fcabe-2383-44c7-af8a-a1a602badeef&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error while getting user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 500 for unknown error while getting user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).throws(new Error(\&quot;Some error related to getting user\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: &#x27;test@example.com&#x27; })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to get user while verifying email&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6c1ef46-ab48-4f37-9b42-b3991593e657&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for unknown user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 404 for unknown user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(null);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: &#x27;test@example.com&#x27; })\n                .expect(404);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;user cannot be found&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c982a2a9-5b69-4a59-8db8-17f36283a9a2&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for user with verified email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 400 for user with verified email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeUserWithoutPassword = {\n                _id: &#x27;existing_id&#x27;,\n                name: &#x27;Existing User&#x27;,\n                email: &#x27;existing@example.com&#x27;,\n                password: &#x27;hashed_password&#x27;,\n                isEmailVerified: true\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(fakeUserWithoutPassword);\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: &#x27;test@example.com&#x27; })\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;email is already verified&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a7aab39-5edd-480a-9e09-0d26b63b347a&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error during resending verification email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 500 for unknown error during resending verification email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeUserWithoutPassword = {\n                _id: &#x27;existing_id&#x27;,\n                name: &#x27;Existing User&#x27;,\n                email: &#x27;existing@example.com&#x27;,\n                password: &#x27;hashed_password&#x27;,\n                isEmailVerified: false\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(fakeUserWithoutPassword);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;resendVerificationEmail&#x27;).throws(new Error(\&quot;Some error related to resending verification email\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: &#x27;test@example.com&#x27; })\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to resend verification email&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b19e732-d927-4686-bb3b-353af44a9846&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for successfully resending email&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/resend-verification POST should return 200 for successfully resending email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeUserWithoutPassword = {\n                _id: &#x27;existing_id&#x27;,\n                name: &#x27;Existing User&#x27;,\n                email: &#x27;existing@example.com&#x27;,\n                password: &#x27;hashed_password&#x27;,\n                isEmailVerified: false\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserByEmail&#x27;).resolves(fakeUserWithoutPassword);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;resendVerificationEmail&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .post(&#x27;/api/profiles/resend-verification&#x27;)\n                .send({ email: &#x27;test@example.com&#x27; })\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Verification email sent&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d3b79c1-947c-4958-aa76-d0caeace079b&quot;,&quot;parentUUID&quot;:&quot;26ecb92b-838f-47de-a53e-80311986dae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d25c1cf3-6f15-4d81-aeb3-65b59c7c4d0f&quot;,&quot;274fcabe-2383-44c7-af8a-a1a602badeef&quot;,&quot;f6c1ef46-ab48-4f37-9b42-b3991593e657&quot;,&quot;c982a2a9-5b69-4a59-8db8-17f36283a9a2&quot;,&quot;2a7aab39-5edd-480a-9e09-0d26b63b347a&quot;,&quot;7b19e732-d927-4686-bb3b-353af44a9846&quot;,&quot;4d3b79c1-947c-4958-aa76-d0caeace079b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:42,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;title&quot;:&quot;/api/profiles/:userId GET&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;/api/profiles/:userId GET\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET \&quot;before each\&quot; hook in \&quot;/api/profiles/:userId GET\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;originalSecret = process.env.JWT_SECRET;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c4ed8ef9-8e4c-4453-ae2b-a6a64765f470&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;/api/profiles/:userId GET\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET \&quot;after each\&quot; hook in \&quot;/api/profiles/:userId GET\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;process.env.JWT_SECRET = originalSecret; // restore&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7cfcb5ca-21aa-47fa-b7be-2657d69878a9&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 401 for no auth token on header&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 401 for no auth token on header&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/&#x27;)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;No auth token in header&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3179222d-cdd3-442f-89c5-f657b63fbc33&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unconfigured JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 500 for unconfigured JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            delete process.env.JWT_SECRET;\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;JWT not configured&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1244cfd4-179e-41f0-82ba-dbad179e699b&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for JWT verification error&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 401 for JWT verification error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new jsonwebtoken_1.JsonWebTokenError(\&quot;Some JWT verification error\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid JWT&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7f0286a-a1e4-43cb-ac85-dcb2533b92d7&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 500 for unknown error JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new Error(\&quot;Some other error during JWT verification\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5f55db2-8ade-470c-8df7-f224ec85705b&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing userId on params&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 400 for missing userId on params&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;userId missing from params&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62cb1ac7-3c8e-49c8-8f67-ce4a7454648c&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for error during getting profile&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 500 for error during getting profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).throws(new Error(\&quot;Some error related to getting user\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error during getting profile&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21677700-a468-45d3-a78c-231a2655df2c&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for missing profile for userId&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 404 for missing profile for userId&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).resolves(null);\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(404);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to get profile with userId&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dada5ee1-9728-401f-ac86-7592bd298a15&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for successfully getting profile&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId GET should return 200 for successfully getting profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            /** Physically verify token without mocking */\n            const fakeProfile = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;test userId&#x27;,\n                storage_preference: &#x27;123GB&#x27;,\n                RAM_preference: &#x27;8GB&#x27;,\n                brand_preference: &#x27;Apple, Samsung, Sony&#x27;,\n                min_budget: 50,\n                max_budget: 500,\n                rating_preference: 5,\n                country: &#x27;Canada&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).resolves(fakeProfile);\n            const response = yield (0, supertest_1.default)(app)\n                .get(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Successfully retrieved profile&#x27;,\n                profile: fakeProfile\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a32f838-c1cd-49fb-9609-e211056be3b2&quot;,&quot;parentUUID&quot;:&quot;2f4f7cc7-142c-4b6d-92da-4376cddb6081&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3179222d-cdd3-442f-89c5-f657b63fbc33&quot;,&quot;1244cfd4-179e-41f0-82ba-dbad179e699b&quot;,&quot;a7f0286a-a1e4-43cb-ac85-dcb2533b92d7&quot;,&quot;c5f55db2-8ade-470c-8df7-f224ec85705b&quot;,&quot;62cb1ac7-3c8e-49c8-8f67-ce4a7454648c&quot;,&quot;21677700-a468-45d3-a78c-231a2655df2c&quot;,&quot;dada5ee1-9728-401f-ac86-7592bd298a15&quot;,&quot;2a32f838-c1cd-49fb-9609-e211056be3b2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:55,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;title&quot;:&quot;/api/profiles/:userId PATCH&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;/api/profiles/:userId PATCH\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH \&quot;before each\&quot; hook in \&quot;/api/profiles/:userId PATCH\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;originalSecret = process.env.JWT_SECRET;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da4d9396-d419-48df-8762-327db3ede069&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;/api/profiles/:userId PATCH\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH \&quot;after each\&quot; hook in \&quot;/api/profiles/:userId PATCH\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;process.env.JWT_SECRET = originalSecret; // restore&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;604739ff-f2ec-4856-baaf-313d2696f432&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 401 for no auth token on header&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 401 for no auth token on header&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/&#x27;)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;No auth token in header&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a013bf0-7ab1-4103-b79c-b440eca519df&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unconfigured JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 500 for unconfigured JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            delete process.env.JWT_SECRET;\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;JWT not configured&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;671258bd-7f09-4eda-a204-f7b2040b61a8&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for JWT verification error&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 401 for JWT verification error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new jsonwebtoken_1.JsonWebTokenError(\&quot;Some JWT verification error\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid JWT&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da0064e6-b1be-4d3c-81da-b41f3ff12f4e&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 500 for unknown error JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new Error(\&quot;Some other error during JWT verification\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;66847014-b2b8-41df-83e3-21ca7d9a386b&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing userId on params&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 400 for missing userId on params&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;userId missing from params&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99428d12-84f7-4f23-a2df-aee0a3ef8690&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing profileData in body&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 400 for missing profileData in body&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .send({ profileData: null })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;profileData missing from body&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4dc64eb3-74fb-4ecf-bb6b-d4ffd71619e8&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for error during getting profile&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 500 for error during getting profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;test userId&#x27;,\n                storage_preference: &#x27;123GB&#x27;,\n                RAM_preference: &#x27;8GB&#x27;,\n                brand_preference: &#x27;Apple, Samsung, Sony&#x27;,\n                min_budget: 50,\n                max_budget: 500,\n                rating_preference: 5,\n                country: &#x27;Canada&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).throws(new Error(\&quot;Some error related to getting user\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .send({ profileData: fakeProfileData })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error during getting profile&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a08a327c-3547-4447-a0e3-cfe5f45fd93f&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for missing profile for userId&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 404 for missing profile for userId&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).resolves(null);\n            const fakeProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;test userId&#x27;,\n                storage_preference: &#x27;123GB&#x27;,\n                RAM_preference: &#x27;8GB&#x27;,\n                brand_preference: &#x27;Apple, Samsung, Sony&#x27;,\n                min_budget: 50,\n                max_budget: 500,\n                rating_preference: 5,\n                country: &#x27;Canada&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .send({ profileData: fakeProfileData })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(404);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;No profile found&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9cf7b3c8-a534-49a2-afb1-a5c9ab3ec781&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for error with updating profile&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 500 for error with updating profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;test userId&#x27;,\n                storage_preference: &#x27;1TB&#x27;,\n                RAM_preference: &#x27;32GB&#x27;,\n                brand_preference: &#x27;NVidia, Intel&#x27;,\n                min_budget: 200,\n                max_budget: 1000,\n                rating_preference: 3,\n                country: &#x27;US&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            const existingProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;test userId&#x27;,\n                storage_preference: &#x27;123GB&#x27;,\n                RAM_preference: &#x27;8GB&#x27;,\n                brand_preference: &#x27;Apple, Samsung, Sony&#x27;,\n                min_budget: 50,\n                max_budget: 500,\n                rating_preference: 5,\n                country: &#x27;Canada&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).resolves(existingProfileData);\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;updateProfile&#x27;).throws(new Error(\&quot;Some error related to updating profile\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .send({ profileData: fakeProfileData })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to update profile&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89d4e7d6-59d1-4ee2-aac7-248f7c65ec43&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for successfully updating profile&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/:userId PATCH should return 200 for successfully updating profile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const fakeProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;userId123&#x27;,\n                storage_preference: &#x27;1TB&#x27;,\n                RAM_preference: &#x27;32GB&#x27;,\n                brand_preference: &#x27;NVidia, Intel&#x27;,\n                min_budget: 200,\n                max_budget: 1000,\n                rating_preference: 3,\n                country: &#x27;US&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            const existingProfileData = {\n                _id: &#x27;test id&#x27;,\n                userId: &#x27;userId123&#x27;,\n                storage_preference: &#x27;123GB&#x27;,\n                RAM_preference: &#x27;8GB&#x27;,\n                brand_preference: &#x27;Apple, Samsung, Sony&#x27;,\n                min_budget: 50,\n                max_budget: 500,\n                rating_preference: 5,\n                country: &#x27;Canada&#x27;,\n                address: {\n                    street: &#x27;test street&#x27;,\n                    city: &#x27;test city&#x27;,\n                    state: &#x27;test state&#x27;,\n                    zipCode: &#x27;test zip code&#x27;,\n                    country: &#x27;test country&#x27;,\n                },\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n                email: &#x27;test@example.com&#x27;,\n            };\n            /** Physically verify token without mocking */\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;getProfileByUserId&#x27;).resolves(existingProfileData);\n            sinon_1.default.stub(ProfileService_1.ProfileService, &#x27;updateProfile&#x27;).resolves(fakeProfileData);\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/userId123&#x27;)\n                .send({ profileData: fakeProfileData })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Profile updated successfully&#x27;,\n                data: fakeProfileData\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6db4f308-8223-4b2b-95d0-bb203fc90a3f&quot;,&quot;parentUUID&quot;:&quot;be72c4af-d145-414d-862d-afe9566567f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5a013bf0-7ab1-4103-b79c-b440eca519df&quot;,&quot;671258bd-7f09-4eda-a204-f7b2040b61a8&quot;,&quot;da0064e6-b1be-4d3c-81da-b41f3ff12f4e&quot;,&quot;66847014-b2b8-41df-83e3-21ca7d9a386b&quot;,&quot;99428d12-84f7-4f23-a2df-aee0a3ef8690&quot;,&quot;4dc64eb3-74fb-4ecf-bb6b-d4ffd71619e8&quot;,&quot;a08a327c-3547-4447-a0e3-cfe5f45fd93f&quot;,&quot;9cf7b3c8-a534-49a2-afb1-a5c9ab3ec781&quot;,&quot;89d4e7d6-59d1-4ee2-aac7-248f7c65ec43&quot;,&quot;6db4f308-8223-4b2b-95d0-bb203fc90a3f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:59,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000},{&quot;uuid&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;title&quot;:&quot;/api/profiles/passwords/:userId&quot;,&quot;fullFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\src\\tests\\integration\\profile.test.ts&quot;,&quot;file&quot;:&quot;\\src\\tests\\integration\\profile.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;/api/profiles/passwords/:userId\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId \&quot;before each\&quot; hook in \&quot;/api/profiles/passwords/:userId\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;originalSecret = process.env.JWT_SECRET;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e0a9206-3c24-4584-b706-27b9321243da&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;/api/profiles/passwords/:userId\&quot;&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId \&quot;after each\&quot; hook in \&quot;/api/profiles/passwords/:userId\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;process.env.JWT_SECRET = originalSecret; // restore&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2362f9de-5b9a-418c-a034-e515554ca62b&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 401 for no auth token on header&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 401 for no auth token on header&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords&#x27;)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;No auth token in header&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;785b1537-5f81-41e0-a66b-ff5545ac51af&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unconfigured JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 500 for unconfigured JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            delete process.env.JWT_SECRET;\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;JWT not configured&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f7304fb1-92e1-4898-9080-9c27790ec288&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for JWT verification error&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 401 for JWT verification error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new jsonwebtoken_1.JsonWebTokenError(\&quot;Some JWT verification error\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Invalid JWT&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bce87620-8beb-4acb-b631-5e48076ff440&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error JWT&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 500 for unknown error JWT&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(jsonwebtoken_1.default, &#x27;verify&#x27;).throws(new Error(\&quot;Some other error during JWT verification\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer sometoken`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;090d8e57-ce94-4bc5-a395-09b5d0029a28&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for userId missing from params&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 400 for userId missing from params&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords&#x27;)\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;userId missing from params&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99d4996f-305d-4ec0-bb58-08ea5c1026c2&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing newPassword&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 400 for missing newPassword&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/test123&#x27;)\n                .send({\n                currentPassword: &#x27;currentPassword&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;currentPassword and newPassword required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f75f0062-b774-4633-bbeb-787f7f818558&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for missing currentPassword&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 400 for missing currentPassword&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/test123&#x27;)\n                .send({\n                newPassword: &#x27;newPassword&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;currentPassword and newPassword required&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d1b69b1-4804-480a-922f-3c5c3ee53b2a&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string currentPassword&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 400 for non string currentPassword&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/test123&#x27;)\n                .send({\n                currentPassword: 123,\n                newPassword: &#x27;newPassword&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;currentPassword and newPassword need to be strings&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12828cf9-af06-4d44-85fb-668c1d5308ea&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non string currentPassword&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 400 for non string currentPassword&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/test123&#x27;)\n                .send({\n                currentPassword: &#x27;test current&#x27;,\n                newPassword: 123\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(400);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;currentPassword and newPassword need to be strings&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fcd818f2-c685-4ec1-90bd-efed9b4e5efd&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for unknown error during getting user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 500 for unknown error during getting user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserById&#x27;).throws(new Error(&#x27;Some error during fetching user&#x27;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .send({\n                currentPassword: &#x27;test current&#x27;,\n                newPassword: &#x27;test new&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unknown error during getting user&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1be6f3ba-f544-410e-81dd-dca9211c64fc&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for unknown user&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 404 for unknown user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserById&#x27;).resolves(null);\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .send({\n                currentPassword: &#x27;test current&#x27;,\n                newPassword: &#x27;test new&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(404);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;No user found&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ba80239-1155-46d6-8a3e-cc71ffcc00f8&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 401 for invalid currentPassword&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 401 for invalid currentPassword&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const userWithPassword = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test1234&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test token&#x27;,\n                verificationTokenExpires: (new Date()).toISOString(),\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserById&#x27;).resolves(userWithPassword);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;comparePassword&#x27;).resolves(false);\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .send({\n                currentPassword: &#x27;test4321&#x27;,\n                newPassword: &#x27;test new&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(401);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Password incorrect&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ebaf1833-36b3-4c4a-981d-aeb8d89960d4&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 for failed password update&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 500 for failed password update&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const userWithPassword = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test1234&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test token&#x27;,\n                verificationTokenExpires: (new Date()).toISOString(),\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserById&#x27;).resolves(userWithPassword);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;comparePassword&#x27;).resolves(true);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;updatePassword&#x27;).throws(new Error(\&quot;Some error related to updating password\&quot;));\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .send({\n                currentPassword: &#x27;test1234&#x27;,\n                newPassword: &#x27;test new&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(500);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: false,\n                error: &#x27;Unable to update password&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c9f4f92-6403-44b4-8f83-08a4e0caeaee&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 200 for successful password update&quot;,&quot;fullTitle&quot;:&quot;Profile API /api/profiles/passwords/:userId should return 200 for successful password update&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;__awaiter(void 0, void 0, void 0, function* () {\n            const userWithPassword = {\n                name: &#x27;test name&#x27;,\n                email: &#x27;test@example.com&#x27;,\n                password: &#x27;test1234&#x27;,\n                isEmailVerified: true,\n                verificationToken: &#x27;test token&#x27;,\n                verificationTokenExpires: (new Date()).toISOString(),\n                createdAt: (new Date()).toISOString(),\n                updatedAt: (new Date()).toISOString(),\n            };\n            sinon_1.default.stub(UserService_1.UserService, &#x27;getUserById&#x27;).resolves(userWithPassword);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;comparePassword&#x27;).resolves(true);\n            sinon_1.default.stub(UserService_1.UserService, &#x27;updatePassword&#x27;).resolves();\n            const response = yield (0, supertest_1.default)(app)\n                .patch(&#x27;/api/profiles/passwords/userId123&#x27;)\n                .send({\n                currentPassword: &#x27;test1234&#x27;,\n                newPassword: &#x27;test new&#x27;\n            })\n                .set(&#x27;Authorization&#x27;, `Bearer ${validToken}`)\n                .expect(200);\n            (0, chai_1.expect)(response.body).to.deep.equal({\n                success: true,\n                message: &#x27;Password updated successfully&#x27;\n            });\n        })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79332f73-3bb8-4934-82ee-ce3e66c4a324&quot;,&quot;parentUUID&quot;:&quot;fe5220a1-b299-4da4-b4b8-9302fe7280e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;785b1537-5f81-41e0-a66b-ff5545ac51af&quot;,&quot;f7304fb1-92e1-4898-9080-9c27790ec288&quot;,&quot;bce87620-8beb-4acb-b631-5e48076ff440&quot;,&quot;090d8e57-ce94-4bc5-a395-09b5d0029a28&quot;,&quot;99d4996f-305d-4ec0-bb58-08ea5c1026c2&quot;,&quot;f75f0062-b774-4633-bbeb-787f7f818558&quot;,&quot;0d1b69b1-4804-480a-922f-3c5c3ee53b2a&quot;,&quot;12828cf9-af06-4d44-85fb-668c1d5308ea&quot;,&quot;fcd818f2-c685-4ec1-90bd-efed9b4e5efd&quot;,&quot;1be6f3ba-f544-410e-81dd-dca9211c64fc&quot;,&quot;3ba80239-1155-46d6-8a3e-cc71ffcc00f8&quot;,&quot;ebaf1833-36b3-4c4a-981d-aeb8d89960d4&quot;,&quot;6c9f4f92-6403-44b4-8f83-08a4e0caeaee&quot;,&quot;79332f73-3bb8-4934-82ee-ce3e66c4a324&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:92,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:20000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:20000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;11.7.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;integration-tests&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;mochawesome-integration&quot;,&quot;reportFilename&quot;:&quot;integration-tests&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;integration-tests&quot;,&quot;reportDir&quot;:&quot;mochawesome-integration&quot;,&quot;reportTitle&quot;:&quot;server&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-integration\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\mochawesome-integration\\integration-tests.json&quot;,&quot;htmlFile&quot;:&quot;D:\\Uni\\C455\\Project\\team10\\server\\mochawesome-integration\\integration-tests.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>